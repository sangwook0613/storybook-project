# ê°„ë‹¨í•œ ì»´í¬ë„ŒíŠ¸ ê°œë°œ

> CDD Component-Driven Development ë°©ë²•ë¡ ì— ë”°ë¼ ì‘ì€ ì»´í¬ë„ŒíŠ¸ë¶€í„° í™”ë©´ê¹Œì§€ ìƒí–¥ì ìœ¼ë¡œ UI ë¥¼ ê°œë°œí•´ë³´ì.
>
> ì²« ë‹¨ê³„ ê°„ë‹¨í•œ ì»´í¬ë„ŒíŠ¸ ê°œë°œë¶€í„° ì‹œì‘í•˜ì.

## Task ì»´í¬ë„ŒíŠ¸

> íŠœí† ë¦¬ì–¼ì˜ í•µì‹¬ì´ ë  ì»´í¬ë„ŒíŠ¸

<img src="https://storybook.js.org/tutorials/intro-to-storybook/task-states-learnstorybook.png" alt="Task ì»´í¬ë„ŒíŠ¸ì˜ 3ê°€ì§€ states" style="zoom:80%;" />

Task ì»´í¬ë„ŒíŠ¸ëŠ” í¬ê²Œ 3ê°€ì§€ ê²½ìš°ë¥¼ ê°€ì§„ë‹¤.

1. ê¸°ë³¸ì ì¸ ìƒíƒœ Default
2. ì¤‘ìš”í•œ í‘œì‹œê°€ ëœ ìƒíƒœ Pinned
3. ì™„ì„±í•œ ìƒíƒœ Archived

ì´ë ‡ê²Œ 3ê°€ì§€ ê²½ìš°ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•´ 2ê°œì˜ propì„ í•„ìš”ë¡œ í•œë‹¤.

1. title - task ë¥¼ ì„¤ëª…í•´ì£¼ëŠ” ë°ì´í„°
2. state - í˜„ì¬ ì–´ë–¤ task ê°€ ëª©ë¡ì— ìˆê³ , ì„ íƒë˜ì—ˆëŠ”ì§€ì— ëŒ€í•œ ë°ì´í„°



### ì„¤ì •í•˜ê¸°

#### Task ê¸°ë³¸ ê³¨ì ì¡ê¸°

> src/components/Task.js

```jsx
import React from 'react';

export default function Task({ task: { id, title, state }, onArchiveTask, onPinTask }) {
  return (
    <div className="list-item">
      <input type="text" value={title} readOnly={true} />
    </div>
  );
}
```

- ë‹¨ìˆœí•œ í˜•íƒœì˜ ì»´í¬ë„ŒíŠ¸ë¡œ ì¸ìë¡œ í¬ê²Œ 3ê°€ì§€ë¥¼ ë°›ëŠ”ë‹¤.
  - `task` : id, title, state ë“± taskì— ëŒ€í•œ ê¸°ë³¸ì ì¸ ì •ë³´ë¥¼ ê°–ëŠ”ë‹¤.
  - `onArchiveTask` : task ì™„ë£Œí–ˆìŒì„ ë§Œë“œëŠ” í•¨ìˆ˜
  - `onPinTask` : ì¤‘ìš”í•œ task ì„ì„ ì²´í¬í•˜ëŠ” í•¨ìˆ˜



> src/components/Task.stories.js ìŠ¤í† ë¦¬ íŒŒì¼

```js
import React from 'react';

import Task from './Task';

export default {
  component: Task,
  title: 'Task',
};

const Template = args => <Task {...args} />;

export const Default = Template.bind({});
Default.args = {
  task: {
    id: '1',
    title: 'Test Task',
    state: 'TASK_INBOX',
    updatedAt: new Date(2018, 0, 1, 9, 0),
  },
};

export const Pinned = Template.bind({});
Pinned.args = {
  task: {
    ...Default.args.task,
    state: 'TASK_PINNED',
  },
};

export const Archived = Template.bind({});
Archived.args = {
  task: {
    ...Default.args.task,
    state: 'TASK_ARCHIVED',
  },
};
```

ë¨¼ì €, Storybookì—ê²Œ ìš°ë¦¬ê°€ ë¬¸ì„œí™”í•˜ê³  ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•´ ì•Œë ¤ì£¼ê¸° ìœ„í•´, ì•„ë˜ ì‚¬í•­ë“¤ì„ í¬í•¨í•˜ëŠ” `default export` ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

- `component` -- í•´ë‹¹ ì»´í¬ë„ŒíŠ¸,
- `title` -- Storybook ì•±ì˜ ì‚¬ì´ë“œë°”ì—ì„œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¸ì¡°í•˜ëŠ” ë°©ë²•



ì•ì„œ ë§Œë“  Task ì»´í¬ë„ŒíŠ¸ë¥¼ í™œìš©í•´ì„œ ìŠ¤í† ë¦¬ë¥¼ ë§Œë“ ë‹¤.

- ë¨¼ì €, Task ì»´í¬ë„ŒíŠ¸ì— args ì¸ìë¥¼ ê°–ëŠ” Template í•¨ìˆ˜ë¥¼ ìƒì„±
- ì´í›„ `bind()` ë©”ì„œë“œë¥¼ í™œìš©í•´ Template í•¨ìˆ˜ë¥¼ ë³µì‚¬í•˜ì—¬ Default, Pinned, Archived ì— ë§ëŠ” state ë¥¼ ê°–ëŠ” ìŠ¤í† ë¦¬ë¥¼ ìƒì„±



#### ++ `bind()` ë©”ì„œë“œ

ë©”ì„œë“œë¥¼ ì ìš©í•œ í•¨ìˆ˜ë¥¼ clone í•˜ì—¬ this ì˜ ì£¼ì²´ë¥¼ `()` ì•ˆì˜ ê°ì²´ë¡œ ë°”ê¾¼ ìƒˆë¡œìš´ í•¨ìˆ˜ ë¥¼ ìƒì„±í•œë‹¤. 

ì´ ë•Œ, ë³µì œí•œ ë¶€ëª¨ í•¨ìˆ˜ì—ê²ŒëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.

```js
var park = {name: 'park', first: 10}
function sum(prefix) {
    return prefix+(this.first*2)
}
var parkSum = sum.bind(park, 'ans : ')
parkSum() // ans : 20
```

`call()` ê³¼ ìœ ì‚¬í•˜ë‚˜, call ì€ this ê°’ì„ ì›í•˜ëŠ” ê°ì²´ë¡œ ë°”ê¿”ì„œ ë°”ë¡œ ì‹¤í–‰í•˜ê³  bind ëŠ” ì‹¤í–‰í•˜ì§€ ì•Šê³  í•¨ìˆ˜ë¥¼ clone í•´ì„œ return í•œë‹¤.



### Config ìˆ˜ì •

> .storybook/main.js

```js
module.exports = {
  //ğŸ‘‡ Location of our stories
  stories: ['../src/components/**/*.stories.js'],
  addons: [
    '@storybook/addon-links',
    '@storybook/addon-essentials',
    '@storybook/preset-create-react-app',
  ],
};
```

- ìµœê·¼ì— ìƒì„±í•œ Task ìŠ¤í† ë¦¬ë¥¼ ì¶”ê°€



> .storybook/preview.js

```js
import '../src/index.css'; //ğŸ‘ˆ The app's CSS file goes here

//ğŸ‘‡ Configures Storybook to log the actions( onArchiveTask and onPinTask ) in the UI.
export const parameters = {
  actions: { argTypesRegex: '^on[A-Z].*' },
};
```

- CSS íŒŒì¼ ì ìš©



ì—¬ê¸°ê¹Œì§€ ì‘ì„± í›„ ì‹¤í–‰ í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ íšë“í•œë‹¤.

ì‹¤í–‰ ì½”ë“œ : `npm run storybook`

https://storybook.js.org/tutorials/intro-to-storybook/inprogress-task-states-6-0.mp4



## States êµ¬í˜„í•˜ê¸°

> ë””ìì¸ì„ ê°–ì¶”ë©´ì„œ Task ì»´í¬ë„ŒíŠ¸ë¥¼ ì¢€ ë” ê¾¸ë©°ë³´ì.
>
> src/components/Task.js

```jsx
import React from 'react';

export default function Task({ task: { id, title, state }, onArchiveTask, onPinTask }) {
  return (
    <div className={`list-item ${state}`}>
      {/* ì™„ë£Œì—¬ë¶€ ì²´í¬ë°•ìŠ¤ */}
      <label className="checkbox">
        <input
          type="checkbox"
          defaultChecked={state === 'TASK_ARCHIVED'}
          disabled={true}
          name="checked"
        />
        <span className="checkbox-custom" onClick={() => onArchiveTask(id)} />
      </label>

      {/* Task ë‚´ìš© ë“¤ì–´ê°ˆ input */}
      <div className="title">
        <input type="text" value={title} readOnly={true} placeholder="Input title" />
      </div>

      {/* ì¤‘ìš”í•œ Task ì²´í¬í•˜ëŠ” íŒŒíŠ¸ */}
      <div className="actions" onClick={event => event.stopPropagation()}>
        {state !== 'TASK_ARCHIVED' && (
          // eslint-disable-next-line jsx-a11y/anchor-is-valid
          <a onClick={() => onPinTask(id)}>
            <span className={`icon-star`} />
          </a>
        )}
      </div>
    </div>
  );
}
```



ì™„ì„± ê²°ê³¼

https://storybook.js.org/tutorials/intro-to-storybook/finished-task-states-6-0.mp4



#### PropTypes ë¥¼ í™œìš©í•´ ìš”êµ¬ì‚¬í•­ ëª…ì‹œí•˜ê¸°

> ë°ì´í„°ì— ë§ëŠ” ìš”êµ¬ ì‚¬í•­ì„ ëª…ì‹œí•˜ì
>
> src/components/Task.js

```jsx
import PropTypes from 'prop-types';

...

Task.propTypes = {
  // Task ì˜ êµ¬ì„±
  task: PropTypes.shape({
    // id = ë¬¸ìì—´, í•„ìˆ˜
    id: PropTypes.string.isRequired,
    // title = ë¬¸ìì—´, í•„ìˆ˜
    title: PropTypes.string.isRequired,
    // state = ë¬¸ìì—´, í•„ìˆ˜
    state: PropTypes.string.isRequired,
  }),
  // Task ê°€ ì™„ë£Œë˜ì—ˆìŒì„ ì•Œë¦¬ëŠ” ì´ë²¤íŠ¸ í•¨ìˆ˜
  onArchiveTask: PropTypes.func,
  // Task ê°€ ì¤‘ìš”í‘œì‹œ(pinned) ë˜ì—ˆìŒì„ ì•Œë¦¬ëŠ” ì´ë²¤íŠ¸ í•¨ìˆ˜
  onPinTask: PropTypes.func,
};
```

- TypeScript ë¥¼ í†µí•´ íƒ€ì…ì„ ëª…ì‹œí•˜ëŠ” ê²ƒì²˜ëŸ¼ ì¼ë°˜ JavaScript ì—ì„œ íƒ€ì…ì„ ëª…ì‹œí•˜ê³  ê²€ì‚¬í•  ìˆ˜ ìˆë„ë¡ ë„ì›€ì„ ì£¼ëŠ” ë°©ë²•ì´ `PropTypes` ì´ë‹¤.



### ìŠ¤ëƒ…ìƒ· í…ŒìŠ¤íŠ¸

Snapshot test ë€, ì–´ë–¤ ê¸°ëŠ¥ì˜ ì˜ˆìƒ ê²°ê³¼ë¥¼ ë¯¸ë¦¬ ì •í™•íˆ í¬ì°©í•´ë‘ê³  ì‹¤ì œ ê²°ê³¼ì— ë¹„êµí•˜ëŠ” í…ŒìŠ¤íŠ¸ ê¸°ë²•ì´ë‹¤.

ì—¬ê¸°ì„œëŠ” Storyshots addon ì„ ì‚¬ìš©í•˜ì—¬ ê° ìŠ¤í† ë¦¬ë§ˆë‹¤ ìŠ¤ëƒ…ìƒ·ì„ ìƒì„±í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.

ìš°ì„  ë‹¤ìŒ ëª…ë ¹ì„ í†µí•´ Storyshots addon ì„ ì¶”ê°€í•˜ì˜€ë‹¤.

```bash
yarn add -D @storybook/addon-storyshots react-test-renderer
```

ì´í›„ ì•„ë˜ íŒŒì¼ ìƒì„±

> src/stroybook.test.js

```js
import initStoryshots from '@storybook/addon-storyshots';
initStoryshots();
```

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ í†µí•´ì„œ ì‹¤í–‰í•˜ì—¬ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

```bash
yarn test
```



ê²°ê³¼

<img src="ê°„ë‹¨í•œ ì»´í¬ë„ŒíŠ¸ ê°œë°œ.assets/image-20220208175613485.png" alt="image-20220208175613485" style="zoom:67%;" />